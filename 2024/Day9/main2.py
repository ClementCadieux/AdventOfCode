def compact(lineMap, filesByLength, fileStartIndex):
    for length in filesByLength:
        filesByLength[length].sort()

    left = 0

    while left = 
